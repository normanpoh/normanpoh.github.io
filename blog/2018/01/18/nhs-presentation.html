<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Norman Poh - Using Machine Learning to Model the Progression of Chronic Kidney Disease: A Case Study</title>
  <meta name="author" content="Norman Poh" />
  <meta name="description" content="The blog of Norman Poh" />
  <link rel="canonical" href="http://normanpoh.github.com/blog/2018/01/18/nhs-presentation.html" />

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="/favicon.png">
  <link rel="alternate" type="application/atom+xml" title="Norman Poh" href="http://normanpoh.github.com/atom.xml" />

  <link rel="stylesheet" href="/assets/css/all.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-k2/8zcNbxVIh5mnQ52A0r3a6jAgMGxFJFE2707UxGCk= sha512-ZV9KawG2Legkwp3nAlxLIVFudTauWuBpC10uEafMHYL0Sarrz5A7G79kXh5+5+woxQ5HM559XX2UZjMJ36Wplg==" crossorigin="anonymous">
   <!-- Load jQuery -->
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<!-- Load KaTeX -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.js"></script>

<!-- header for today -->

<script type="text/javascript">
var today = new Date();
var dd = today.getDate();
var mm = today.getMonth()+1; //January is 0!
var yyyy = today.getFullYear();

if(dd<10) {
    dd = '0'+dd
} 

if(mm<10) {
    mm = '0'+mm
} 

today = mm + '/' + dd + '/' + yyyy;
</script>

</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <h1> </h1> 
  <a href="/">
    
    <img src="/assets/norman_round.png" id="logo" alt="Norman's photo" width="200"/>
    
  </a>
  <h2><a href="/">Norman Poh</a></h2>
  <div id="bio">
    <p>Senior lecturer, data scientist, consultant</p> 
	<hr> 
	<ul>
	  <li><a href="http://www.snf.ch/en/funding/careers/postdoc-mobility">Swiss NSF Advanced Researcher Fellow</a></li>
	  <li><a href="https://www.mrc.ac.uk/funding/how-we-fund-research/new-investigator-research-grant/">MRC NIRG Investigator</a> </li> 
	  <li><a href="https://www.heacademy.ac.uk"> HEA Fellow</a></li>
	  <li><a href="https://www.surrey.ac.uk"> Researcher of the year 2011, University of Surrey </a></li>
	</ul>  
	<p><a href="/blog/2017/12/24/me.html"> Short Bio </a></p>
	<hr>   
    <p>Ask me about <a href="/tag/biometrics.html"> biometrics</a>, <a href="/tag/healthcare.html"> healthcare</a>, <a href="/tag/kidney-research.html"> modelling of CKD progression</a> and predictive analytics or <a href="/tag/research.html">research</a></p>
  </div>
  <div id="social">
    Follow me:
<div id="stalker">
  
  <a title="normanpoh on Github" href="https://github.com/normanpoh">
    <i class="fa fa-github-square"></i>
  </a>
  

  
  <a title="normanpoh on gitlab" href="https://gitlab.com/normanpoh">
    <i class="fa fa-github-square"></i>
  </a>
  

  

  

  

  

  

  

  

  
  <a title="Norman Poh on LinkedIn" href="https://www.linkedin.com/in/normanpoh">
    <i class="fa fa-linkedin-square"></i>
  </a>
  

  

  

  
  <a title="Atom feed" id="atom" href="/atom.xml">
    <i class="fa fa-rss-square"></i>
  </a>
  
</div>

  </div>

  <div id="tags">
    <span >
  
  
  
    <a href="/tag/biometrics.html" rel="tag">
      biometrics 
  
    ,
  
    </a>
  
    <a href="/tag/healthcare.html" rel="tag">
      healthcare 
  
    ,
  
    </a>
  
    <a href="/tag/kidney-research.html" rel="tag">
      kidney-research 
  
    ,
  
    </a>
  
    <a href="/tag/latex.html" rel="tag">
      latex 
  
    ,
  
    </a>
  
    <a href="/tag/research.html" rel="tag">
      research 
  
    ,
  
    </a>
  
    <a href="/tag/resume.html" rel="tag">
      resume 
  
    ,
  
    </a>
  
    <a href="/tag/tutorial.html" rel="tag">
      tutorial 
  
    ,
  
    </a>
  
    <a href="/tag/virtual-machine.html" rel="tag">
      virtual-machine 
  
    .
    
    </a>
  

</span>
  </div>
</nav>

    </div>

    <div class="eleven columns content">
      <p class="meta">
  January 18, 2018
  <a href="/">
    <i class="home fa fa-home"></i>
  </a>
</p>

<h1 class="title">Using Machine Learning to Model the Progression of Chronic Kidney Disease: A Case Study</h1>

<div id="post">
  <p>This was part of my presentation made in Leeds, 2018. This blog provides more information about my slides.</p>

<ol>
  <li><a href="#context">Context</a></li>
  <li><a href="#find_clusters">Finding Patients with Drastic Decline in CKD</a></li>
  <li><a href="#stratify">Stratify Patients at Point of Care by Their CKD Stage and Progression</a></li>
  <li><a href="#ml-tasks">Demonstrating Three Common Machine Learning Tasks: Automatic CKD Trend Classification and Patient Clustering
</a></li>
  <li><a href="#computer_vision">Computer Vision - Machine Learning Applied to Imaging</a></li>
  <li><a href="#cite">Cite this blog</a></li>
</ol>

<h2 id="context">Context</h2>
<p><a name="context"></a></p>

<p>Like many domains, the healthcare resource utilisation is not evenly distributed; but follows the Pareto principle, also known as the “80/20 rule”. Unsurprisingly, the majority of healthcare resource utilisation are consumed by few. These patients often have multimorbidities such as diabetes, CVD, CKD, etc. If they have mental health conditions, then their outcome is almost invariably worse than those who don’t.</p>

<p>Here, we pick chronic kidney disease, or CKD, as a case study and an example of a long term condition.</p>

<p>According to a <a href="https://academic.oup.com/ndt/article/27/suppl_3/iii73/1822662">2012 kidney care study published in Nephrology Dialysis Transplantation</a>, CKD was estimated to cost £1.5 billion or 1.3% of all NHS spending in 2009-2010. More than half were spent on renal replacement therapy. So, preventive care, i.e., keeping CKD patients as healthy as possible is key to maintaining high quality of life-years.</p>

<p><strong>Acknowledgements</strong>: The results reported in this blog are made possible thanks to a funding from the <a href="http://gtr.rcuk.ac.uk/projects?ref=MR%2FM023281%2F1">Medical Research Council awarded to Norman under its Investigator Research Grant scheme</a> when he was with the University of Surrey. An overaching objective of this project was to find an innovative way to objectively measure CKD progression.</p>

<h2 id="finding-patients-with-drastic-decline-in-ckd">Finding Patients with Drastic Decline in CKD</h2>
<p><a name="find_clusters"></a></p>

<p><img src="/assets/ckd/eGFR_drastic_decline.png" alt="eGFR hierarchical modelling" style="width: 100%;" /></p>

<p>The figure above shows 2 contrasting clusters of eGFR trends. eGFR (the Y-axis) stands for estimated Glomerular Filtration Rate. It is a measure of the kidney efficiency. X is the age, so CKD patients are typically range from the age of 40 until 100. The above diagram is the result of a systematic anlaysis of the eGFR trend, produced by using a clustering algorithm. We have divided some 20,000 patients into 16 clusters with various degrees of CKD progression. We have shown here the trends of the first and last cluster of these CKD patients. It is obvious that the first cluster, as shown above is qualified to be labelled as drastic CKD progression. This is only possible if we have used advanced machine learning methods – the ones that are robust of local fluctuation, which is adapted to identifying signal from noise.</p>

<h2 id="stratify-patients-at-point-of-care-by-their-ckd-stage-and-progression">Stratify Patients at Point of Care by Their CKD Stage and Progression</h2>
<p><a name="stratify"></a>
<img src="/assets/ckd/refined_ckd_risk.png" alt="eGFR hierarchical modelling" style="width: 100%;" /></p>

<p>eGFR is used by clinician to define disease stages, with lower being worse and higher being healthy. If we plot this on the X-axis and then plot the eGFR annual rate change, again estimated using regression in the Y-axis, then we can stratify patients now by not only their disease stage but also by their progression. Therefore, CKD can better be managed by using regression – a machine learning method.</p>

<p>The regression algorithm that we have used here is a state-of-the-art algorithm known as a probabilistic broken stick model; but this is not part of the scope of this talk.</p>

<h2 id="demonstrating-three-common-machine-learning-tasks-automatic-ckd-trend-classification-and-patient-clustering">Demonstrating Three Common Machine Learning Tasks: Automatic CKD Trend Classification and Patient Clustering</h2>
<p><a name="ml-tasks"></a></p>

<p>We have seen regression which is one of the most common machine learning tasks; the others are classification and clustering, as shown below.</p>

<p><img src="/assets/ckd/eGFR_classification_regression_clustering.png" alt="eGFR hierarchical modelling" style="width: 100%;" /></p>

<p>In the above left diagram, we show how trends can be classified into three different classes, namely, progressive linear, stable and progressive step-wise. If these are done by hands, labelling 2000 patients would take more than a day; but using machine learning, this can be done in a matter of minutes, with an accuracy comparable to human.</p>

<p>If we take all historical clinical medical records of CKD patients, and apply some feature extraction and dimensionality reduction algorithms, we can then start clustering patients by their trajectory, as shown on the right diagram above. This is different from the current established way for classifying patients by disease stages; because we are putting patients with similar “disease trajectory” together. This is a novel way of clustering patients, leading to potentially more tailored treatment regime and potentially even better estimation of the risk of progressive CKD.</p>

<h2 id="computer-vision---machine-learning-applied-to-imaging">Computer Vision - Machine Learning Applied to Imaging</h2>
<p><a name="computer_vision"></a></p>

<p>Last but not least, machine learning is also used to process images, a field known as computer vision. The figure below shows how we apply a modified algorithm of Dynamic Mode Decomposition, which was developed in the field of Computational Field Dynamics, to processing MRi images of kidney captured when the organ is under perfusion. Here, DMD was used to stablise an image. This used to be difficult problem but can be solved easily using DMD, without the need to annotate each image in the sequence, which is extremely time consuming. This is an illustration of how computer vision which relies on machine learning, can accelerate clinicians’ workflow from hours to minutes.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/Oyj2utakNx8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe>

<h2 id="whats-next">What’s next?</h2>
<p><a name="whatnext"></a>
Find out more about <a href="/tag/kidney-research.html">other kidney research blogs here</a>.</p>

</div>

<!--- begin adding the citation -->

  
<H3> Cite this blog post </H3>
<a name="cite"></a>
<hr>

<div class="w3-bar w3-black">
  <button class="w3-bar-item w3-button tablink w3-red" onclick="openReference(event,'Bibtex')">Bibtex</button>
  <button class="w3-bar-item w3-button tablink" onclick="openReference(event,'MLA')">MLA</button>
  <button class="w3-bar-item w3-button tablink" onclick="openReference(event,'APA')">APA</button>
</div>

  <div id="Bibtex" class="w3-container w3-border bibref">
      <h2>Bibtex</h2>

    
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    @misc<span class="o">{</span> poh_2018_01_18_nhs-presentation,
      <span class="nv">author</span> <span class="o">=</span> <span class="o">{</span>Norman Poh<span class="o">}</span>,
      <span class="nv">title</span> <span class="o">=</span> <span class="o">{</span> Using Machine Learning to Model the Progression of Chronic Kidney Disease: A Case Study <span class="o">}</span>,
      <span class="nv">howpublished</span> <span class="o">=</span> <span class="o">{</span><span class="se">\u</span>rl<span class="o">{</span> http://normanpoh.github.com/blog/2018/01/18/nhs-presentation.html<span class="o">}</span>,
      <span class="nv">note</span> <span class="o">=</span> <span class="s2">&quot;Accessed: ___TODAY___&quot;</span>
    <span class="o">}</span>
    </code></pre></figure>


  </div>

  <div id="MLA" class="w3-container w3-border bibref" style="display:none">
    <ul>
      <li>
      Poh, Norman. "Using Machine Learning to Model the Progression of Chronic Kidney Disease: A Case Study". <i> Norman Poh's Github Blog</i>, 2018.
      <a href="http://normanpoh.github.com/blog/2018/01/18/nhs-presentation.html"> http://normanpoh.github.com/blog/2018/01/18/nhs-presentation.html </a>.  
      Accessed <script type="text/javascript"> document.write(today); </script>.
    </li>
    <ul>
  </div>

  <div id="APA" class="w3-container w3-border bibref" style="display:none">
    <ul>
      <li>
      Poh, Norman (2018). "Using Machine Learning to Model the Progression of Chronic Kidney Disease: A Case Study". <i> Norman Poh's Github Blog</i>, 
      <a href="http://normanpoh.github.com/blog/2018/01/18/nhs-presentation.html"> http://normanpoh.github.com/blog/2018/01/18/nhs-presentation.html </a>. 
      Accessed <script type="text/javascript"> document.write(today); </script>.
    </li>
    <ul>
  </div> 

<script>
function openReference(evt, bibrefName) {
  var i, x, tablinks;
  x = document.getElementsByClassName("bibref");
  for (i = 0; i < x.length; i++) {
      x[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablink");
  for (i = 0; i < x.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" w3-red", "");
  }
  document.getElementById(bibrefName).style.display = "block";
  evt.currentTarget.className += " w3-red";
}
</script>


<script type="text/javascript"> 
  window.onload = replace_today; 
  function replace_today() { 
    document.body.innerHTML = document.body.innerHTML.replace('___TODAY___', today);
  }
</script>
<hr>


<!--- end -->


<div id="related">
  <h3>Related Posts</h3>
  <ul class="posts">
    
    <li>
      <span>17 Jan 2018 &raquo;</span> <a href="/blog/2018/01/17/mrc-ckd-project.html">Modelling the Progression of CKD - The MRC CKD project</a>
    </li>
    
    <li>
      <span>15 Jan 2018 &raquo;</span> <a href="/blog/2018/01/15/ckd-aki-demo.html">A Software Demo for Modelling CKD and Detecting AKI</a>
    </li>
    
    <li>
      <span>14 Jan 2018 &raquo;</span> <a href="/blog/2018/01/14/sakida.html">Surrey AKI Detection Algorithm (SAKIDA) - Introduction and Software Demo</a>
    </li>
    
  </ul>

  <h3>Tags :</h3>
  <span>
    
      <a href="/tag/kidney-research.html" rel="tag"> 
        kidney-research 
        
        ,
        
      </a>

      <a href="/tag/healthcare.html" rel="tag"> 
        healthcare 
        
        .
        
      </a>

  </span>
</div>



      <div class="footer">
        <div class="disclaimer">
  
  <p>
    The postings on this site are my own and don't necessarily represent my 
    employer’s positions, strategies or opinions.
  </p>
  

  <p>
    © Norman Poh, 2018 &mdash; built with 
<a href="http://jekyllrb.com/">Jekyll</a> using 
<a href="https://github.com/swanson/lagom">Lagom theme </a> and 
<a href="https://github.com/Khan/KaTeX"> Katex </a>
  </p>
</div>


      </div>
    </div>
  </div>


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-111544249-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<script type="text/javascript">

$("script[type='math/tex']").replaceWith(
  function(){
    var tex = $(this).text();
    return "<span class=\"inline-equation\">" + 
           katex.renderToString(tex) +
           "</span>";
});

$("script[type='math/tex; mode=display']").replaceWith(
  function(){
    var tex = $(this).text();
    return "<div class=\"equation\">" + 
           katex.renderToString("\\displaystyle "+tex) +
           "</div>";
});

</script>


</body>
</html>
